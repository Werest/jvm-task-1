# Задача "Понимание JVM"

## Описание
Просмотрите код ниже и опишите (текстово или с картинками) каждую строку с точки зрения происходящего в JVM

Не забудьте упомянуть про:
- ClassLoader'ы,
- области памяти (стэк (и его фреймы), хип, метаспейс)
- сборщик мусора

## Код для исследования
```java

public class JvmComprehension { //1

    public static void main(String[] args) { //2
        int i = 1;                      // 3
        Object o = new Object();        // 4
        Integer ii = 2;                 // 5
        printAll(o, i, ii);             // 6
        System.out.println("finished"); // 9
    }

    private static void printAll(Object o, int i, Integer ii) {
        Integer uselessVar = 700;                   // 7
        System.out.println(o.toString() + i + ii);  // 8
    }
}
```

1. `public class JvmComprehension {`

**ClassLoader** загружает в **Metaspace** системные классы, а так же мета данные класса **JvmComprehension**

2. `public static void main(String[] args) {`

В **Stack** создаётся **фрейм(кадр) main()**

3. `int i = 1;`

**В фрейм main()** создаётся переменная **i** со значением **1** 

4. `Object o = new Object();`

**В Heap(куча)** выделяется память для объекта класса **Object**, оператор **new** возвращает ссылку на область памяти кучи. 
**В фрейм main()** определяется переменная **o** в переменной хранится ссылка на **Object** из **Heap**

5. `Integer ii = 2;`

**В Heap(куча)** выделяется память для объекта класса **Integer** и инициализируется **со значением 2**, оператор **new** возвращает ссылку на область памяти кучи.
**В фрейм main()** определяется перемененная **ii**, которая хранит ссылку на **Integer** из **Heap**
Данная запись, равносильна `Integer ii = new Integer(2);`

6. `printAll(o, i, ii);`

В Stack создаётся новый фрейм **printAll**. В новом фрейме определяются:
- переменная **o** со ссылкой на объект **Object** из **Heap**
- переменная **i** со значением 2
- переменная **ii** со ссылкой на объект **Integer** из **Heap**

7. `Integer uselessVar = 700;`

**В Heap(куча)** выделяется память для объекта класса **Integer** и инициализируется **со значением 700**, оператор **new** возвращает ссылку на область памяти кучи.
**В фрейм printAll()** определяется перемененная **uselessVar**, которая хранит ссылку на **Integer** из **Heap**

8. `System.out.println(o.toString() + i + ii);`

У каждого поля **o**, **i**, **ii** вызывается метод toString().
Каждый вызов создаёт фрейм в Stack, после удаляется.

В **Heap** выделяется память для процедуры конкатенации строк.

В **Stack** создаётся новый **фрейм println()** и в него помещается ссылка **процедуры конкатенации из Heap**.
После выполнения **метода println()**, **фрейм** удалится из **Stack**

GB - Garbage Collector (сборщик мусора) - при следующем запуске может удалить новый объект **String** из **Heap**,
_т.к. отсутствует ссылка на объект_

9. `System.out.println("finished")`

В **Heap** выделяется память для объекта класса **String** и инициализируется со значением **finished**
В **Stack** создаётся новый фрейм для метода println()
Ссылка на объект из Heap помещается в фрейм println()
В конце выполнения метода println() фрейм из Stack удаляется
Фрейм main() из Stack удаляется.
